<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Neural AI Assistant</title>
    <style>
      :root {
        --bg-primary: #0a0a0a;
        --bg-secondary: #111111;
        --bg-card: rgba(255, 255, 255, 0.03);
        --text-primary: #ffffff;
        --text-secondary: #a1a1aa;
        --text-accent: #10b981;
        --border: rgba(255, 255, 255, 0.08);
        --glow: rgba(16, 185, 129, 0.3);
        --neural-blue: #3b82f6;
        --neural-purple: #8b5cf6;
        --neural-pink: #ec4899;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "SF Pro Display", -apple-system, BlinkMacSystemFont,
          "Segoe UI", Roboto, sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        min-height: 100vh;
        overflow: hidden;
        position: relative;
      }

      /* Neural Network Background */
      .neural-bg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        opacity: 0.1;
        z-index: 0;
      }

      .neural-node {
        position: absolute;
        width: 2px;
        height: 2px;
        background: var(--text-accent);
        border-radius: 50%;
        animation: pulse-node 3s ease-in-out infinite;
      }

      .neural-connection {
        position: absolute;
        height: 1px;
        background: linear-gradient(
          90deg,
          transparent,
          var(--text-accent),
          transparent
        );
        opacity: 0.3;
        animation: flow 4s linear infinite;
      }

      @keyframes pulse-node {
        0%,
        100% {
          opacity: 0.3;
          transform: scale(1);
        }
        50% {
          opacity: 1;
          transform: scale(1.5);
        }
      }

      @keyframes flow {
        0% {
          transform: translateX(-100%);
          opacity: 0;
        }
        50% {
          opacity: 1;
        }
        100% {
          transform: translateX(100%);
          opacity: 0;
        }
      }

      /* Main Container */
      .ai-container {
        position: relative;
        z-index: 1;
        width: 100vw;
        height: 100vh;
        display: flex;
        flex-direction: column;
        backdrop-filter: blur(20px);
      }

      /* Header */
      .ai-header {
        padding: 20px 40px;
        background: var(--bg-card);
        border-bottom: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .ai-title {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 20px;
        font-weight: 700;
      }

      .ai-logo {
        width: 32px;
        height: 32px;
        background: linear-gradient(
          135deg,
          var(--neural-blue),
          var(--neural-purple)
        );
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
      }

      .ai-logo::before {
        content: "🧠";
        font-size: 16px;
        position: relative;
        z-index: 1;
      }

      .ai-logo::after {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        animation: shine 3s infinite;
      }

      @keyframes shine {
        0% {
          left: -100%;
        }
        100% {
          left: 100%;
        }
      }

      .status-indicator {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        color: var(--text-secondary);
      }

      .status-dot {
        width: 8px;
        height: 8px;
        background: var(--text-accent);
        border-radius: 50%;
        animation: pulse 2s infinite;
      }

      /* Chat Area */
      .chat-area {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      .messages-container {
        flex: 1;
        padding: 20px 40px;
        overflow-y: auto;
        scroll-behavior: smooth;
      }

      .message {
        margin-bottom: 32px;
        max-width: none;
        animation: messageSlide 0.6s ease-out;
      }

      @keyframes messageSlide {
        from {
          opacity: 0;
          transform: translateY(30px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .message-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 12px;
      }

      .avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        position: relative;
      }

      .avatar.user {
        background: linear-gradient(
          135deg,
          var(--neural-pink),
          var(--neural-purple)
        );
      }

      .avatar.ai {
        background: linear-gradient(
          135deg,
          var(--neural-blue),
          var(--text-accent)
        );
        animation: aiGlow 3s ease-in-out infinite;
      }

      @keyframes aiGlow {
        0%,
        100% {
          box-shadow: 0 0 20px var(--glow);
        }
        50% {
          box-shadow: 0 0 40px var(--glow), 0 0 60px var(--glow);
        }
      }

      .message-info {
        flex: 1;
      }

      .sender-name {
        font-weight: 600;
        font-size: 16px;
        margin-bottom: 4px;
      }

      .message-time {
        font-size: 12px;
        color: var(--text-secondary);
        opacity: 0.7;
      }

      .message-content {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 20px;
        margin-left: 52px;
        position: relative;
        backdrop-filter: blur(10px);
      }

      .message-content.ai {
        border: 1px solid rgba(16, 185, 129, 0.2);
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.05) 0%,
          rgba(59, 130, 246, 0.03) 50%,
          rgba(139, 92, 246, 0.05) 100%
        );
      }

      .thinking-indicator {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 16px 20px;
        color: var(--text-secondary);
        font-style: italic;
      }

      .neural-spinner {
        width: 20px;
        height: 20px;
        position: relative;
      }

      .neural-spinner::before {
        content: "";
        position: absolute;
        width: 100%;
        height: 100%;
        border: 2px solid transparent;
        border-top: 2px solid var(--text-accent);
        border-radius: 50%;
        animation: neuralSpin 1s linear infinite;
      }

      .neural-spinner::after {
        content: "";
        position: absolute;
        top: 2px;
        left: 2px;
        width: calc(100% - 4px);
        height: calc(100% - 4px);
        border: 2px solid transparent;
        border-bottom: 2px solid var(--neural-blue);
        border-radius: 50%;
        animation: neuralSpin 1.5s linear infinite reverse;
      }

      @keyframes neuralSpin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .sources-panel {
        margin-top: 20px;
        padding: 16px;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid var(--border);
        border-radius: 12px;
      }

      .sources-title {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-accent);
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .source-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 8px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      }

      .source-item:last-child {
        border-bottom: none;
      }

      .source-icon {
        font-size: 16px;
      }

      .source-info {
        flex: 1;
      }

      .source-title {
        font-size: 13px;
        color: var(--text-primary);
        font-weight: 500;
      }

      .source-url {
        font-size: 11px;
        color: var(--text-secondary);
        text-decoration: none;
      }

      .source-url:hover {
        color: var(--text-accent);
      }

      .confidence-badge {
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 10px;
        font-weight: 600;
        text-transform: uppercase;
      }

      .confidence-high {
        background: rgba(16, 185, 129, 0.2);
        color: var(--text-accent);
      }

      .confidence-medium {
        background: rgba(249, 115, 22, 0.2);
        color: #f97316;
      }

      /* Input Area */
      .input-area {
        padding: 20px 40px;
        background: var(--bg-card);
        border-top: 1px solid var(--border);
      }

      .input-container {
        position: relative;
        display: flex;
        gap: 12px;
        align-items: flex-end;
      }

      .input-wrapper {
        flex: 1;
        position: relative;
      }

      .ai-input {
        width: 100%;
        background: var(--bg-secondary);
        border: 2px solid var(--border);
        border-radius: 16px;
        padding: 16px 50px 16px 20px;
        color: var(--text-primary);
        font-size: 16px;
        line-height: 1.5;
        resize: none;
        min-height: 56px;
        max-height: 200px;
        transition: all 0.3s ease;
      }

      .ai-input:focus {
        outline: none;
        border-color: var(--text-accent);
        box-shadow: 0 0 0 3px var(--glow);
      }

      .ai-input::placeholder {
        color: var(--text-secondary);
      }

      .input-actions {
        position: absolute;
        right: 12px;
        bottom: 12px;
        display: flex;
        gap: 8px;
      }

      .send-btn {
        width: 40px;
        height: 40px;
        background: linear-gradient(
          135deg,
          var(--text-accent),
          var(--neural-blue)
        );
        border: none;
        border-radius: 10px;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        font-size: 18px;
      }

      .send-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px var(--glow);
      }

      .send-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      /* Scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
      }

      ::-webkit-scrollbar-track {
        background: var(--bg-secondary);
      }

      ::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 3px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--text-secondary);
      }

      /* Typewriter effect */
      .typewriter {
        overflow: hidden;
        border-right: 2px solid var(--text-accent);
        animation: typewriter 0.05s steps(1) forwards, blink 1s infinite;
      }

      @keyframes blink {
        0%,
        50% {
          border-color: var(--text-accent);
        }
        51%,
        100% {
          border-color: transparent;
        }
      }

      /* Responsive */
      @media (max-width: 768px) {
        .ai-header,
        .input-area,
        .messages-container {
          padding-left: 20px;
          padding-right: 20px;
        }

        .message-content {
          margin-left: 28px;
        }
      }
    </style>
  </head>
  <body>
    <div class="neural-bg" id="neuralBg"></div>

    <div class="ai-container">
      <header class="ai-header">
        <div class="ai-title">
          <div class="ai-logo"></div>
          <span>Neural AI Assistant</span>
        </div>
        <div class="status-indicator">
          <div class="status-dot"></div>
          <span>Online • GPT-4 Level</span>
        </div>
      </header>

      <div class="chat-area">
        <div class="messages-container" id="messagesContainer">
          <div class="message">
            <div class="message-header">
              <div class="avatar ai">🤖</div>
              <div class="message-info">
                <div class="sender-name">Neural AI</div>
                <div class="message-time" id="currentTime"></div>
              </div>
            </div>
            <div class="message-content ai">
              <div id="welcomeText"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="input-area">
        <div class="input-container">
          <div class="input-wrapper">
            <textarea
              class="ai-input"
              id="aiInput"
              placeholder="Ask me anything... I can search, analyze, and reason like a human."
              rows="1"
            ></textarea>
            <div class="input-actions">
              <button class="send-btn" id="sendBtn">
                <span>➤</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      class NeuralAI {
        constructor() {
          this.messagesContainer = document.getElementById("messagesContainer");
          this.aiInput = document.getElementById("aiInput");
          this.sendBtn = document.getElementById("sendBtn");

          this.context = [];
          this.isProcessing = false;

          this.initializeNeuralBackground();
          this.setupEventListeners();
          this.displayWelcomeMessage();
          this.updateTime();
        }

        initializeNeuralBackground() {
          const neuralBg = document.getElementById("neuralBg");
          const nodeCount = 50;
          const connectionCount = 30;

          // Create neural nodes
          for (let i = 0; i < nodeCount; i++) {
            const node = document.createElement("div");
            node.className = "neural-node";
            node.style.left = Math.random() * 100 + "%";
            node.style.top = Math.random() * 100 + "%";
            node.style.animationDelay = Math.random() * 3 + "s";
            neuralBg.appendChild(node);
          }

          // Create neural connections
          for (let i = 0; i < connectionCount; i++) {
            const connection = document.createElement("div");
            connection.className = "neural-connection";
            connection.style.left = Math.random() * 100 + "%";
            connection.style.top = Math.random() * 100 + "%";
            connection.style.width = 50 + Math.random() * 200 + "px";
            connection.style.transform = `rotate(${Math.random() * 360}deg)`;
            connection.style.animationDelay = Math.random() * 4 + "s";
            neuralBg.appendChild(connection);
          }
        }

        setupEventListeners() {
          this.sendBtn.addEventListener("click", () => this.processMessage());
          this.aiInput.addEventListener("keydown", (e) => {
            if (e.key === "Enter" && !e.shiftKey) {
              e.preventDefault();
              this.processMessage();
            }
          });
          this.aiInput.addEventListener("input", () => this.autoResizeInput());
        }

        autoResizeInput() {
          this.aiInput.style.height = "auto";
          this.aiInput.style.height =
            Math.min(this.aiInput.scrollHeight, 200) + "px";
        }

        updateTime() {
          const now = new Date();
          document.getElementById("currentTime").textContent =
            now.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
        }

        async displayWelcomeMessage() {
          const welcomeText =
            "Hello! I'm your Neural AI Assistant. I can understand context, search the web, analyze data, solve problems, and engage in meaningful conversations. What would you like to explore today?";
          await this.typewriterEffect(
            document.getElementById("welcomeText"),
            welcomeText
          );
        }

        async typewriterEffect(element, text) {
          element.textContent = "";
          for (let i = 0; i < text.length; i++) {
            element.textContent += text[i];
            await new Promise((resolve) => setTimeout(resolve, 30));
          }
        }

        async processMessage() {
          const message = this.aiInput.value.trim();
          if (!message || this.isProcessing) return;

          this.isProcessing = true;
          this.sendBtn.disabled = true;

          // Add user message
          this.addMessage(message, "user");
          this.aiInput.value = "";
          this.autoResizeInput();

          // Add thinking indicator
          const thinkingElement = this.addThinkingIndicator();

          try {
            // Process the message with AI intelligence
            const response = await this.generateIntelligentResponse(message);

            // Remove thinking indicator
            thinkingElement.remove();

            // Add AI response
            await this.addAIMessage(response);
          } catch (error) {
            console.error("Error processing message:", error);
            thinkingElement.remove();
            await this.addAIMessage({
              text: "I apologize, but I encountered an error processing your request. Please try again.",
              sources: [],
            });
          }

          this.isProcessing = false;
          this.sendBtn.disabled = false;
          this.aiInput.focus();
        }

        addMessage(text, sender) {
          const messageDiv = document.createElement("div");
          messageDiv.className = "message";
          messageDiv.innerHTML = `
                    <div class="message-header">
                        <div class="avatar ${sender}">${
            sender === "user" ? "👤" : "🤖"
          }</div>
                        <div class="message-info">
                            <div class="sender-name">${
                              sender === "user" ? "You" : "Neural AI"
                            }</div>
                            <div class="message-time">${new Date().toLocaleTimeString(
                              [],
                              { hour: "2-digit", minute: "2-digit" }
                            )}</div>
                        </div>
                    </div>
                    <div class="message-content ${sender}">
                        <div>${this.escapeHtml(text)}</div>
                    </div>
                `;
          this.messagesContainer.appendChild(messageDiv);
          this.scrollToBottom();
        }

        addThinkingIndicator() {
          const thinkingDiv = document.createElement("div");
          thinkingDiv.className = "message";
          thinkingDiv.innerHTML = `
                    <div class="message-header">
                        <div class="avatar ai">🤖</div>
                        <div class="message-info">
                            <div class="sender-name">Neural AI</div>
                            <div class="message-time">${new Date().toLocaleTimeString(
                              [],
                              { hour: "2-digit", minute: "2-digit" }
                            )}</div>
                        </div>
                    </div>
                    <div class="message-content ai">
                        <div class="thinking-indicator">
                            <div class="neural-spinner"></div>
                            <span>Processing your request through neural networks...</span>
                        </div>
                    </div>
                `;
          this.messagesContainer.appendChild(thinkingDiv);
          this.scrollToBottom();
          return thinkingDiv;
        }

        async addAIMessage(response) {
          const messageDiv = document.createElement("div");
          messageDiv.className = "message";

          const messageHeader = `
                    <div class="message-header">
                        <div class="avatar ai">🤖</div>
                        <div class="message-info">
                            <div class="sender-name">Neural AI</div>
                            <div class="message-time">${new Date().toLocaleTimeString(
                              [],
                              { hour: "2-digit", minute: "2-digit" }
                            )}</div>
                        </div>
                    </div>
                `;

          let messageContent =
            '<div class="message-content ai"><div class="typewriter-container">';

          if (response.sources && response.sources.length > 0) {
            messageContent += this.formatSources(response.sources);
          }

          messageContent += "</div></div>";

          messageDiv.innerHTML = messageHeader + messageContent;
          this.messagesContainer.appendChild(messageDiv);

          // Typewriter effect for the response
          const textContainer = messageDiv.querySelector(
            ".typewriter-container"
          );
          await this.typewriterEffect(textContainer, response.text);

          this.scrollToBottom();
        }

        async generateIntelligentResponse(message) {
          // Add to context
          this.context.push({ role: "user", content: message });

          // Analyze the message for intent and complexity
          const analysis = this.analyzeMessage(message);

          let response = { text: "", sources: [] };

          if (analysis.needsWebSearch) {
            // Fetch real data from APIs
            const webData = await this.searchWeb(message);
            response = this.synthesizeWithWebData(message, webData, analysis);
          } else {
            // Generate contextual response
            response = this.generateContextualResponse(message, analysis);
          }

          // Add to context
          this.context.push({ role: "assistant", content: response.text });

          return response;
        }

        analyzeMessage(message) {
          const lowerMessage = message.toLowerCase();

          return {
            isQuestion:
              /^(what|how|why|when|where|who|which|can|could|would|should|is|are|do|does|did)/.test(
                lowerMessage
              ),
            needsWebSearch: this.needsWebSearch(lowerMessage),
            category: this.categorizeMessage(lowerMessage),
            complexity: this.assessComplexity(message),
            keywords: this.extractKeywords(message),
            sentiment: this.analyzeSentiment(lowerMessage),
          };
        }

        needsWebSearch(message) {
          const webSearchTriggers = [
            "current",
            "latest",
            "recent",
            "news",
            "today",
            "2024",
            "2025",
            "define",
            "definition",
            "what is",
            "who is",
            "where is",
            "price",
            "cost",
            "weather",
            "stock",
            "market",
          ];
          return webSearchTriggers.some((trigger) => message.includes(trigger));
        }

        categorizeMessage(message) {
          const categories = {
            technology: [
              "ai",
              "computer",
              "software",
              "programming",
              "tech",
              "internet",
              "code",
            ],
            science: [
              "science",
              "research",
              "study",
              "experiment",
              "theory",
              "physics",
              "chemistry",
            ],
            business: [
              "business",
              "company",
              "market",
              "economy",
              "finance",
              "money",
            ],
            personal: ["help", "advice", "recommend", "suggest", "opinion"],
            creative: ["write", "create", "design", "story", "poem", "art"],
          };

          for (const [category, keywords] of Object.entries(categories)) {
            if (keywords.some((keyword) => message.includes(keyword))) {
              return category;
            }
          }
          return "general";
        }

        assessComplexity(message) {
          const wordCount = message.split(" ").length;
          const hasComplexWords =
            /\b(analyze|comprehensive|sophisticated|implementation|methodology)\b/i.test(
              message
            );

          if (wordCount > 20 || hasComplexWords) return "high";
          if (wordCount > 10) return "medium";
          return "low";
        }

        extractKeywords(message) {
          const stopWords = [
            "a",
            "about",
            "above",
            "after",
            "again",
            "against",
            "all",
            "am",
            "an",
            "and",
            "any",
            "are",
            "aren't",
            "as",
            "at",
            "be",
            "because",
            "been",
            "before",
            "being",
            "below",
            "between",
            "both",
            "but",
            "by",
            "can",
            "can't",
            "could",
            "couldn't",
            "did",
            "didn't",
            "do",
            "does",
            "doesn't",
            "doing",
            "don't",
            "down",
            "during",
            "each",
            "few",
            "for",
            "from",
            "further",
            "had",
            "hadn't",
            "has",
            "hasn't",
            "have",
            "haven't",
            "having",
            "he",
            "he'd",
            "he'll",
            "he's",
            "her",
            "here",
            "here's",
            "hers",
            "herself",
            "him",
            "himself",
            "his",
            "how",
            "how's",
            "i",
            "i'd",
            "i'll",
            "i'm",
            "i've",
            "if",
            "in",
            "into",
            "is",
            "isn't",
            "it",
            "it's",
            "its",
            "itself",
            "let's",
            "me",
            "more",
            "most",
            "mustn't",
            "my",
            "myself",
            "no",
            "nor",
            "not",
            "of",
            "off",
            "on",
            "once",
            "only",
            "or",
            "other",
            "ought",
            "our",
            "ours",
            "ourselves",
            "out",
            "over",
            "own",
            "same",
            "shan't",
            "she",
            "she'd",
            "she'll",
            "she's",
            "should",
            "shouldn't",
            "so",
            "some",
            "such",
            "than",
            "that",
            "that's",
            "the",
            "their",
            "theirs",
            "them",
            "themselves",
            "then",
            "there",
            "there's",
            "these",
            "they",
            "they'd",
            "they'll",
            "they're",
            "they've",
            "this",
            "those",
            "through",
            "to",
            "too",
            "under",
            "until",
            "up",
            "very",
            "was",
            "wasn't",
            "we",
            "we'd",
            "we'll",
            "we're",
            "we've",
            "were",
            "weren't",
            "what",
            "what's",
            "when",
            "when's",
            "where",
            "where's",
            "which",
            "while",
            "who",
            "who's",
            "whom",
            "why",
            "why's",
            "with",
            "won't",
            "would",
            "wouldn't",
            "you",
            "you'd",
            "you'll",
            "you're",
            "you've",
            "your",
            "yours",
            "yourself",
            "yourselves",
          ];

          return message
            .toLowerCase()
            .replace(/[^\w\s]/g, "") // ex: "hello, world!" → "hello world", Remove punctuation (keep only letters, numbers, underscores, and spaces)
            .split(/\s+/) // ex: "hello world" → ["hello", "world"]
            .filter((word) => word.length > 3 && !stopWords.includes(word)) // ex: ["i","want","to","learn","java"] → ["learn","java"]   // 3) Keep only words longer than 3 chars AND not in the stop words list
            .slice(0, 5); // ex: ["learn","java","start","hints"] → ["learn","java","start","hints"]   // 4) Take only the first 5 results
        }

        analyzeSentiment(message) {
          const positive =
            /\b(good|great|excellent|amazing|wonderful|love|like|happy|pleased)\b/i.test(
              message
            );
          const negative =
            /\b(bad|terrible|awful|hate|dislike|sad|angry|frustrated|problem|issue)\b/i.test(
              message
            );

          if (positive && !negative) return "positive";
          if (negative && !positive) return "negative";
          return "neutral";
        }

        async searchWeb(query) {
          const sources = [];

          try {
            // Wikipedia search
            const wikiData = await this.searchWikipedia(query);
            if (wikiData) sources.push(wikiData);

            // Dictionary search
            const dictData = await this.searchDictionary(query);
            if (dictData) sources.push(dictData);

            // Add more sources as needed
          } catch (error) {
            console.error("Web search error:", error);
          }

          return sources;
        }

        async searchWikipedia(query) {
          try {
            const keywords = this.extractKeywords(query);
            const searchTerm = keywords[0] || query.split(" ")[0];

            const response = await fetch(
              `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(
                searchTerm
              )}`
            );
            if (response.ok) {
              const data = await response.json();
              return {
                title: `Wikipedia: ${data.title}`,
                url:
                  data.content_urls?.desktop?.page ||
                  `https://en.wikipedia.org/wiki/${encodeURIComponent(
                    searchTerm
                  )}`,
                content: data.extract || "",
                confidence: "high",
                type: "encyclopedia",
              };
            }
          } catch (error) {
            console.error("Wikipedia search failed:", error);
          }
          return null;
        }

        async searchDictionary(query) {
          try {
            const keywords = this.extractKeywords(query);
            const word =
              keywords.find((w) => w.length > 3) ||
              query.split(" ").find((w) => w.length > 3);

            if (word) {
              const response = await fetch(
                `https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(
                  word
                )}`
              );
              if (response.ok) {
                const data = await response.json();
                if (data && data.length > 0) {
                  const entry = data[0];
                  const definition =
                    entry.meanings?.[0]?.definitions?.[0]?.definition || "";

                  return {
                    title: `Dictionary: ${entry.word}`,
                    url: `https://www.merriam-webster.com/dictionary/${encodeURIComponent(
                      word
                    )}`,
                    content: definition,
                    confidence: "high",
                    type: "dictionary",
                  };
                }
              }
            }
          } catch (error) {
            console.error("Dictionary search failed:", error);
          }
          return null;
        }

        synthesizeWithWebData(query, webData, analysis) {
          let text = "";

          if (webData.length === 0) {
            text = this.generateFallbackResponse(query, analysis);
          } else {
            // Synthesize response from web data
            const primarySource = webData[0];
            text = `Based on my research, ${primarySource.content}`;

            if (analysis.complexity === "high") {
              text += ` This is a complex topic that involves multiple factors and considerations. Let me break this down further based on the available information.`;
            }

            // Add contextual analysis
            if (analysis.category === "technology") {
              text += ` From a technological perspective, this represents current developments in the field.`;
            } else if (analysis.category === "science") {
              text += ` The scientific consensus on this topic is based on peer-reviewed research and evidence.`;
            }

            // Add multiple source perspectives if available
            if (webData.length > 1) {
              text += ` Additional sources provide complementary information that supports this understanding.`;
            }
          }

          return {
            text: text,
            sources: webData,
          };
        }

        generateContextualResponse(query, analysis) {
          const responses = {
            technology: this.generateTechResponse(query, analysis),
            science: this.generateScienceResponse(query, analysis),
            business: this.generateBusinessResponse(query, analysis),
            personal: this.generatePersonalResponse(query, analysis),
            creative: this.generateCreativeResponse(query, analysis),
            general: this.generateGeneralResponse(query, analysis),
          };

          return {
            text: responses[analysis.category] || responses.general,
            sources: [],
          };
        }

        generateTechResponse(query, analysis) {
          const techResponses = [
            `From a technical standpoint, ${query.toLowerCase()} involves several key considerations. The current state of technology allows for sophisticated implementations, though there are always trade-offs between performance, scalability, and maintainability.`,
            `In the technology landscape, this relates to emerging trends and established best practices. The solution approach would depend on specific requirements, technical constraints, and the desired user experience.`,
            `This technology question touches on fundamental concepts that are evolving rapidly. Modern approaches prioritize efficiency, security, and user-centric design principles.`,
          ];
          return techResponses[
            Math.floor(Math.random() * techResponses.length)
          ];
        }

        generateScienceResponse(query, analysis) {
          return `From a scientific perspective, this involves understanding underlying principles and mechanisms. Current research in this area builds upon established theories while exploring new hypotheses. The methodology for studying this would involve systematic observation, experimentation, and peer review to validate findings.`;
        }

        generateBusinessResponse(query, analysis) {
          return `In the business context, this relates to strategic considerations including market dynamics, competitive advantages, and value creation. Modern business approaches emphasize data-driven decision making, customer-centric solutions, and sustainable growth strategies.`;
        }

        generatePersonalResponse(query, analysis) {
          const sentiment = analysis.sentiment;
          let response = `I understand you're looking for guidance on this matter. `;

          if (sentiment === "positive") {
            response += `It's great that you're approaching this with a positive mindset. `;
          } else if (sentiment === "negative") {
            response += `I can sense this might be challenging for you, and that's completely understandable. `;
          }

          response += `Based on general principles and common experiences, I'd suggest considering multiple perspectives, evaluating your specific circumstances, and taking a structured approach to decision-making.`;

          return response;
        }

        generateCreativeResponse(query, analysis) {
          return `For creative endeavors like this, the key is balancing inspiration with structure. Consider exploring different approaches, experimenting with various techniques, and allowing for iterative refinement. Creativity often emerges from the intersection of knowledge, experimentation, and personal expression.`;
        }

        generateGeneralResponse(query, analysis) {
          if (analysis.isQuestion) {
            return `That's an interesting question about ${analysis.keywords.join(
              ", "
            )}. While I don't have specific real-time data on this topic, I can share that this generally involves understanding the underlying concepts, considering multiple perspectives, and applying critical thinking to evaluate different approaches or solutions.`;
          } else {
            return `I understand you're interested in ${analysis.keywords.join(
              ", "
            )}. This is a topic that can be approached from various angles, and the best path forward would depend on your specific goals, context, and constraints. Would you like me to explore any particular aspect in more detail?`;
          }
        }

        generateFallbackResponse(query, analysis) {
          return `I've analyzed your question about "${query}" and while I don't have access to current web data on this specific topic, I can provide insights based on my training. This appears to be a ${analysis.complexity}-complexity ${analysis.category} question. Would you like me to break down the key concepts or explore related areas that might be helpful?`;
        }

        formatSources(sources) {
          if (sources.length === 0) return "";

          let html =
            '<div class="sources-panel"><div class="sources-title">🔍 Sources Analyzed</div>';

          sources.forEach((source) => {
            const icon = this.getSourceIcon(source.type);
            const confidenceClass = `confidence-${source.confidence}`;

            html += `
                        <div class="source-item">
                            <div class="source-icon">${icon}</div>
                            <div class="source-info">
                                <div class="source-title">${source.title}</div>
                                <a href="${
                                  source.url
                                }" target="_blank" class="source-url">${this.truncateUrl(
              source.url
            )}</a>
                            </div>
                            <div class="confidence-badge ${confidenceClass}">${
              source.confidence
            }</div>
                        </div>
                    `;
          });

          html += "</div>";
          return html;
        }

        getSourceIcon(type) {
          const icons = {
            encyclopedia: "📚",
            dictionary: "📖",
            news: "📰",
            scientific: "🔬",
            government: "🏛️",
            academic: "🎓",
            general: "🌐",
          };
          return icons[type] || "📄";
        }

        truncateUrl(url) {
          try {
            const domain = new URL(url).hostname.replace("www.", "");
            return domain.length > 30
              ? domain.substring(0, 30) + "..."
              : domain;
          } catch {
            return url.length > 30 ? url.substring(0, 30) + "..." : url;
          }
        }

        scrollToBottom() {
          this.messagesContainer.scrollTop =
            this.messagesContainer.scrollHeight;
        }

        escapeHtml(text) {
          const div = document.createElement("div");
          div.textContent = text;
          return div.innerHTML;
        }
      }

      // Initialize the Neural AI
      document.addEventListener("DOMContentLoaded", () => {
        new NeuralAI();
      });

      // Add some dynamic effects
      setInterval(() => {
        const nodes = document.querySelectorAll(".neural-node");
        const randomNode = nodes[Math.floor(Math.random() * nodes.length)];
        if (randomNode) {
          randomNode.style.animationDuration = 2 + Math.random() * 2 + "s";
        }
      }, 3000);
    </script>
  </body>
</html>
